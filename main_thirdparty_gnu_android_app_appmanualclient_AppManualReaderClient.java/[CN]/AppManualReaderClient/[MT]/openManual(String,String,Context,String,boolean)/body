{
  String localePath="/" + context.getResources().getConfiguration().locale.toString();
  Intent intent=new Intent(Intent.ACTION_VIEW);
  int defaultIntentFlags=intent.getFlags();
  intent.addCategory(Intent.CATEGORY_DEFAULT);
  while (true) {
    Uri uri=Uri.parse(URI_SCHEME_APPMANUAL + "://" + manualIdentifier+ localePath+ "#topic='"+ topic+ "'");
    intent.setData(uri);
    intent.setFlags(defaultIntentFlags);
    if (contextAffinity) {
      List<ResolveInfo> capableActivities=context.getPackageManager().queryIntentActivityOptions(null,null,intent,PackageManager.MATCH_DEFAULT_ONLY);
      int capables=capableActivities.size();
      if (capables > 1) {
        for (int idx=0; idx < capables; ++idx) {
          ActivityInfo activityInfo=capableActivities.get(idx).activityInfo;
          if (activityInfo.packageName.contentEquals(context.getPackageName())) {
            intent.setClassName(activityInfo.packageName,activityInfo.name);
            break;
          }
        }
      }
      intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_WHEN_TASK_RESET);
    }
 else {
      intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_SINGLE_TOP | Intent.FLAG_ACTIVITY_RESET_TASK_IF_NEEDED);
    }
    try {
      String logTag="appmanualclient";
      if (Log.isLoggable(logTag,Log.INFO)) {
        Log.i(logTag,"Trying to activate manual: uri=" + uri.toString());
      }
      context.startActivity(intent);
      return;
    }
 catch (    ActivityNotFoundException noActivity) {
      intent.setComponent(null);
      if (localePath.length() > 1) {
        int underscore=localePath.lastIndexOf('_');
        if (underscore > 0) {
          localePath=localePath.substring(0,underscore);
          if (localePath.endsWith("_")) {
            localePath=localePath.substring(0,underscore - 1);
          }
        }
 else {
          localePath="/";
        }
      }
 else {
        break;
      }
    }
  }
  if (fallbackUri != null) {
    intent=new Intent(Intent.ACTION_VIEW,Uri.parse(fallbackUri));
    intent.addCategory(Intent.CATEGORY_BROWSABLE);
    context.startActivity(intent);
  }
  throw new ActivityNotFoundException();
}
