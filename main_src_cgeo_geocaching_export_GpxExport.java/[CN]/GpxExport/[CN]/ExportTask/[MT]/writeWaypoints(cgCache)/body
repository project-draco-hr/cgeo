{
  List<Waypoint> waypoints=cache.getWaypoints();
  List<Waypoint> ownWaypoints=new ArrayList<Waypoint>(waypoints.size());
  List<Waypoint> originWaypoints=new ArrayList<Waypoint>(waypoints.size());
  for (  Waypoint wp : cache.getWaypoints()) {
    if (wp.isUserDefined()) {
      ownWaypoints.add(wp);
    }
 else {
      originWaypoints.add(wp);
    }
  }
  int maxPrefix=0;
  for (  Waypoint wp : originWaypoints) {
    String prefix=wp.getPrefix();
    try {
      maxPrefix=Math.max(Integer.parseInt(prefix),maxPrefix);
    }
 catch (    NumberFormatException ex) {
      Log.e("Unexpected origin waypoint prefix='" + prefix + "'",ex);
    }
    writeCacheWaypoint(wp,prefix);
  }
  for (  Waypoint wp : ownWaypoints) {
    maxPrefix++;
    String prefix=StringUtils.leftPad(String.valueOf(maxPrefix),2,'0');
    writeCacheWaypoint(wp,prefix);
  }
}
