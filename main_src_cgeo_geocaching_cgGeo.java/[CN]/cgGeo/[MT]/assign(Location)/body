{
  if (loc == null) {
    locationProvider=LocationProviderType.LAST;
    return;
  }
  location=loc;
  final String provider=location.getProvider();
  if (provider.equals(LocationManager.GPS_PROVIDER)) {
    locationProvider=LocationProviderType.GPS;
  }
 else   if (provider.equals(LocationManager.NETWORK_PROVIDER)) {
    locationProvider=LocationProviderType.NETWORK;
  }
 else   if (provider.equalsIgnoreCase(LAST_LOCATION_PSEUDO_PROVIDER)) {
    locationProvider=LocationProviderType.LAST;
  }
  coordsNow=new Geopoint(location.getLatitude(),location.getLongitude());
  cgeoapplication.getInstance().setLastCoords(coordsNow);
  if (location.hasAltitude() && locationProvider != LocationProviderType.LAST) {
    altitudeNow=location.getAltitude() + Settings.getAltCorrection();
  }
 else {
    altitudeNow=null;
  }
  if (location.hasBearing() && locationProvider != LocationProviderType.LAST) {
    bearingNow=location.getBearing();
  }
 else {
    bearingNow=0f;
  }
  if (location.hasSpeed() && locationProvider != LocationProviderType.LAST) {
    speedNow=location.getSpeed();
  }
 else {
    speedNow=0f;
  }
  if (location.hasAccuracy() && locationProvider != LocationProviderType.LAST) {
    accuracyNow=location.getAccuracy();
  }
 else {
    accuracyNow=999f;
  }
  fireLocationCallback();
  if (locationProvider == LocationProviderType.GPS || locationProvider == LocationProviderType.NETWORK) {
    Go4Cache.signalCoordinates(coordsNow);
  }
}
