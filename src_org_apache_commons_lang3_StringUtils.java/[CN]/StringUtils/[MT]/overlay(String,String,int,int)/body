{
  if (str == null) {
    return null;
  }
  if (overlay == null) {
    overlay=EMPTY;
  }
  int len=str.length();
  if (start < 0) {
    start=0;
  }
  if (start > len) {
    start=len;
  }
  if (end < 0) {
    end=0;
  }
  if (end > len) {
    end=len;
  }
  if (start > end) {
    int temp=start;
    start=end;
    end=temp;
  }
  return new StringBuilder(len + start - end + overlay.length() + 1).append(str.substring(0,start)).append(overlay).append(str.substring(end)).toString();
}
