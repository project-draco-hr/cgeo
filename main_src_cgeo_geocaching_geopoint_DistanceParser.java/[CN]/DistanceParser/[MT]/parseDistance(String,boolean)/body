{
  final MatcherWrapper matcher=new MatcherWrapper(pattern,distanceText);
  if (!matcher.find()) {
    throw new NumberFormatException(distanceText);
  }
  final float value=Float.parseFloat(matcher.group(1).replace(',','.'));
  final String unit=matcher.group(2).toLowerCase(Locale.US);
  if (unit.equals("m") || (StringUtils.isEmpty(unit) && metricUnit)) {
    return value / 1000;
  }
  if (unit.equals("km")) {
    return value;
  }
  if (unit.equals("yd")) {
    return value * IConversion.YARDS_TO_KILOMETER;
  }
  if (unit.equals("mi")) {
    return value * IConversion.MILES_TO_KILOMETER;
  }
  return value * IConversion.FEET_TO_KILOMETER;
}
