{
  cgeoapplication app=cgeoapplication.getInstance();
  int listId1=StoredList.STANDARD_LIST_ID;
  int listId2=StoredList.STANDARD_LIST_ID;
  final cgCache cache1=new cgCache();
  cache1.setGeocode("Cache 1");
  final cgCache cache2=new cgCache();
  cache2.setGeocode("Cache 2");
  assertNotNull(cache2);
  try {
    listId1=app.createList("cgData Test");
    assertTrue(listId1 > StoredList.STANDARD_LIST_ID);
    listId2=app.createList("cgDataTest");
    assertTrue(listId2 > StoredList.STANDARD_LIST_ID);
    assertTrue(app.getLists().size() >= 2);
    cache1.setDetailed(true);
    cache1.setListId(listId1);
    cache2.setDetailed(true);
    cache2.setListId(listId1);
    app.saveCache(cache1,LoadFlags.SAVE_ALL);
    app.saveCache(cache2,LoadFlags.SAVE_ALL);
    assertTrue(app.getAllStoredCachesCount(false,CacheType.ALL,null) >= 2);
    assertEquals(1,app.renameList(listId1,"cgData Test (renamed)"));
    StoredList list1=app.getList(listId1);
    assertEquals("cgData Test (renamed)",list1.title);
    app.moveToList(cache1.getGeocode(),listId2);
    assertEquals(1,app.getAllStoredCachesCount(false,CacheType.ALL,listId2));
    assertTrue(app.removeList(listId1));
    app.markDropped(cache2.getGeocode());
    app.markStored(cache2.getGeocode(),listId2);
    assertEquals(2,app.getAllStoredCachesCount(false,CacheType.ALL,listId2));
    app.dropList(listId2);
  }
  finally {
    Set<String> geocodes=new HashSet<String>();
    geocodes.add(cache1.getGeocode());
    geocodes.add(cache2.getGeocode());
    app.removeCaches(geocodes,LoadFlags.REMOVE_ALL);
    app.removeList(listId1);
    app.removeList(listId2);
  }
}
