{
  File gc31j2h=new File(tempDir,"gc31j2h.gpx");
  copyResourceToFile(R.raw.gc31j2h,gc31j2h);
  copyResourceToFile(R.raw.gc31j2h_wpts,new File(tempDir,"gc31j2h-wpts.gpx"));
  cgeogpxes.ImportGpxFileThread importThread=new cgeogpxes.ImportGpxFileThread(gc31j2h,listId,importStepHandler,progressHandler);
  importThread.run();
  assertEquals(4,importStepHandler.messages.size());
  assertEquals(cgeogpxes.IMPORT_STEP_READ_FILE,importStepHandler.messages.get(0).what);
  assertEquals(cgeogpxes.IMPORT_STEP_READ_WPT_FILE,importStepHandler.messages.get(1).what);
  assertEquals(cgeogpxes.IMPORT_STEP_STORE_CACHES,importStepHandler.messages.get(2).what);
  assertEquals(cgeogpxes.IMPORT_STEP_FINISHED,importStepHandler.messages.get(3).what);
  cgSearch search=(cgSearch)importStepHandler.messages.get(3).obj;
  assertEquals(Collections.singletonList("GC31J2H"),search.getGeocodes());
  cgCache cache=cgeoapplication.getInstance().getCacheByGeocode("GC31J2H");
  assertNotNull(cache);
  assertEquals(2,cache.waypoints.size());
}
