{
  final int id=item.getItemId();
  ContextMenu.ContextMenuInfo info=item.getMenuInfo();
  if (info == null) {
    info=lastMenuInfo;
    lastMenuInfo=null;
  }
  AdapterContextMenuInfo adapterInfo=null;
  try {
    adapterInfo=(AdapterContextMenuInfo)info;
  }
 catch (  Exception e) {
    Log.w(Settings.tag,"cgeocaches.onContextItemSelected: " + e.toString());
  }
  if (id == MENU_COMPASS) {
    final Intent navigateIntent=new Intent(this,cgeonavigate.class);
    final cgCache cache=getCacheFromAdapter(adapterInfo);
    navigateIntent.putExtra("latitude",cache.getCoords().getLatitude());
    navigateIntent.putExtra("longitude",cache.getCoords().getLongitude());
    navigateIntent.putExtra("geocode",cache.getGeocode().toUpperCase());
    navigateIntent.putExtra("name",cache.getName());
    startActivity(navigateIntent);
    return true;
  }
 else   if (id == MENU_LOG_VISIT) {
    return getCacheFromAdapter(adapterInfo).logVisit(this);
  }
 else   if (id == MENU_CACHE_DETAILS) {
    final Intent cachesIntent=new Intent(this,cgeodetail.class);
    final cgCache cache=getCacheFromAdapter(adapterInfo);
    cachesIntent.putExtra("geocode",cache.getGeocode().toUpperCase());
    cachesIntent.putExtra("name",cache.getName());
    startActivity(cachesIntent);
    return true;
  }
 else   if (id == MENU_FILTER_SIZE_MICRO) {
    return setFilter(new cgFilterBySize(CacheSize.MICRO));
  }
 else   if (id == MENU_FILTER_SIZE_SMALL) {
    return setFilter(new cgFilterBySize(CacheSize.SMALL));
  }
 else   if (id == MENU_FILTER_SIZE_REGULAR) {
    return setFilter(new cgFilterBySize(CacheSize.REGULAR));
  }
 else   if (id == MENU_FILTER_SIZE_LARGE) {
    return setFilter(new cgFilterBySize(CacheSize.LARGE));
  }
 else   if (id == MENU_FILTER_SIZE_OTHER) {
    return setFilter(new cgFilterBySize(CacheSize.OTHER));
  }
 else   if (id == MENU_FILTER_SIZE_VIRTUAL) {
    return setFilter(new cgFilterBySize(CacheSize.VIRTUAL));
  }
 else   if (id == MENU_FILTER_SIZE_NOT_CHOSEN) {
    return setFilter(new cgFilterBySize(CacheSize.NOT_CHOSEN));
  }
 else   if (id == MENU_FILTER_TYPE_TRADITIONAL) {
    return setFilter(new cgFilterByType(CacheType.TRADITIONAL));
  }
 else   if (id == MENU_FILTER_TYPE_MULTI) {
    return setFilter(new cgFilterByType(CacheType.MULTI));
  }
 else   if (id == MENU_FILTER_TYPE_MYSTERY) {
    return setFilter(new cgFilterByType(CacheType.MYSTERY));
  }
 else   if (id == MENU_FILTER_TYPE_LETTERBOX) {
    return setFilter(new cgFilterByType(CacheType.LETTERBOX));
  }
 else   if (id == MENU_FILTER_TYPE_EVENT) {
    return setFilter(new cgFilterByType(CacheType.EVENT));
  }
 else   if (id == MENU_FILTER_TYPE_MEGA) {
    return setFilter(new cgFilterByType(CacheType.MEGA_EVENT));
  }
 else   if (id == MENU_FILTER_TYPE_EARTH) {
    return setFilter(new cgFilterByType(CacheType.EARTH));
  }
 else   if (id == MENU_FILTER_TYPE_CITO) {
    return setFilter(new cgFilterByType(CacheType.CITO));
  }
 else   if (id == MENU_FILTER_TYPE_WEBCAM) {
    return setFilter(new cgFilterByType(CacheType.WEBCAM));
  }
 else   if (id == MENU_FILTER_TYPE_VIRTUAL) {
    return setFilter(new cgFilterByType(CacheType.VIRTUAL));
  }
 else   if (id == MENU_FILTER_TYPE_WHERIGO) {
    return setFilter(new cgFilterByType(CacheType.WHERIGO));
  }
 else   if (id == MENU_FILTER_TYPE_LOSTFOUND) {
    return setFilter(new cgFilterByType(CacheType.LOSTANDFOUND));
  }
 else   if (id == MENU_FILTER_TYPE_APE) {
    return setFilter(new cgFilterByType(CacheType.PROJECT_APE));
  }
 else   if (id == MENU_FILTER_TYPE_GCHQ) {
    return setFilter(new cgFilterByType(CacheType.GCHQ));
  }
 else   if (id == MENU_FILTER_TYPE_GPS) {
    return setFilter(new cgFilterByType(CacheType.GPS_EXHIBIT));
  }
 else   if (id == MENU_DROP_CACHE) {
    cgBase.dropCache(app,getCacheFromAdapter(adapterInfo),new Handler(){
      @Override public void handleMessage(      Message msg){
        refreshCurrentList();
      }
    }
);
    return true;
  }
 else   if (id >= CONTEXT_MENU_MOVE_TO_LIST && id < CONTEXT_MENU_MOVE_TO_LIST + 100) {
    final int newListId=id - CONTEXT_MENU_MOVE_TO_LIST;
    if (adapterInfo != null) {
      app.moveToList(getCacheFromAdapter(adapterInfo).getGeocode(),newListId);
    }
    adapter.resetChecks();
    refreshCurrentList();
    return true;
  }
 else   if (id >= MENU_MOVE_SELECTED_OR_ALL_TO_LIST && id < MENU_MOVE_SELECTED_OR_ALL_TO_LIST + 100) {
    final int newListId=id - MENU_MOVE_SELECTED_OR_ALL_TO_LIST;
    final boolean moveAll=adapter.getChecked() == 0;
    for (    final cgCache c : Collections.unmodifiableList(cacheList)) {
      if (moveAll || c.isStatusChecked()) {
        app.moveToList(c.getGeocode(),newListId);
      }
    }
    adapter.resetChecks();
    refreshCurrentList();
    return true;
  }
  lastMenuInfo=info;
  if (adapterInfo != null) {
    final cgCache cache=getCacheFromAdapter(adapterInfo);
    final cgSearch singleSearch=base.searchByGeocode(cache.getGeocode(),null,0,false,null);
    if (NavigationAppFactory.onMenuItemSelected(item,geo,this,res,cache,singleSearch,null,null)) {
      return true;
    }
    int logType=id - MENU_LOG_VISIT_OFFLINE;
    cache.logOffline(this,logType);
  }
  return true;
}
