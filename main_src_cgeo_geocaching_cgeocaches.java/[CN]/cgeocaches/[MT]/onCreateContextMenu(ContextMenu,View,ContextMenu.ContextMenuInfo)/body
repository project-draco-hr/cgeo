{
  super.onCreateContextMenu(menu,view,info);
  if (adapter == null) {
    return;
  }
  if (contextMenuMoveToList) {
    createFakeContextMenuMoveToList(menu);
    return;
  }
  AdapterContextMenuInfo adapterInfo=null;
  try {
    adapterInfo=(AdapterContextMenuInfo)info;
  }
 catch (  Exception e) {
    Log.w(Settings.tag,"cgeocaches.onCreateContextMenu: " + e.toString());
  }
  if ((adapterInfo == null || adapterInfo.position < 0 || contextMenuShowFilter) && selectedFilter != null) {
    if (selectedFilter.equals(res.getString(R.string.caches_filter_size))) {
      menu.setHeaderTitle(res.getString(R.string.caches_filter_size_title));
      menu.add(0,MENU_FILTER_SIZE_MICRO,0,res.getString(CacheSize.MICRO.stringId));
      menu.add(0,MENU_FILTER_SIZE_SMALL,0,res.getString(CacheSize.SMALL.stringId));
      menu.add(0,MENU_FILTER_SIZE_REGULAR,0,res.getString(CacheSize.REGULAR.stringId));
      menu.add(0,MENU_FILTER_SIZE_LARGE,0,res.getString(CacheSize.LARGE.stringId));
      menu.add(0,MENU_FILTER_SIZE_OTHER,0,res.getString(CacheSize.OTHER.stringId));
      menu.add(0,MENU_FILTER_SIZE_VIRTUAL,0,res.getString(CacheSize.VIRTUAL.stringId));
      menu.add(0,MENU_FILTER_SIZE_NOT_CHOSEN,0,res.getString(CacheSize.NOT_CHOSEN.stringId));
    }
 else     if (selectedFilter.equals(res.getString(R.string.caches_filter_type))) {
      menu.setHeaderTitle(res.getString(R.string.caches_filter_type_title));
      menu.add(0,MENU_FILTER_TYPE_TRADITIONAL,0,res.getString(CacheType.TRADITIONAL.stringId));
      menu.add(0,MENU_FILTER_TYPE_MULTI,0,res.getString(CacheType.MULTI.stringId));
      menu.add(0,MENU_FILTER_TYPE_MYSTERY,0,res.getString(CacheType.MYSTERY.stringId));
      menu.add(0,MENU_FILTER_TYPE_LETTERBOX,0,res.getString(CacheType.LETTERBOX.stringId));
      menu.add(0,MENU_FILTER_TYPE_EVENT,0,res.getString(CacheType.EVENT.stringId));
      menu.add(0,MENU_FILTER_TYPE_MEGA,0,res.getString(CacheType.MEGA_EVENT.stringId));
      menu.add(0,MENU_FILTER_TYPE_EARTH,0,res.getString(CacheType.EARTH.stringId));
      menu.add(0,MENU_FILTER_TYPE_CITO,0,res.getString(CacheType.CITO.stringId));
      menu.add(0,MENU_FILTER_TYPE_WEBCAM,0,res.getString(CacheType.WEBCAM.stringId));
      menu.add(0,MENU_FILTER_TYPE_VIRTUAL,0,res.getString(CacheType.VIRTUAL.stringId));
      menu.add(0,MENU_FILTER_TYPE_WHERIGO,0,res.getString(CacheType.WHERIGO.stringId));
      menu.add(0,MENU_FILTER_TYPE_LOSTFOUND,0,res.getString(CacheType.LOSTANDFOUND.stringId));
      menu.add(0,MENU_FILTER_TYPE_APE,0,res.getString(CacheType.PROJECT_APE.stringId));
      menu.add(0,MENU_FILTER_TYPE_GCHQ,0,res.getString(CacheType.GCHQ.stringId));
      menu.add(0,MENU_FILTER_TYPE_GPS,0,res.getString(CacheType.GPS_EXHIBIT.stringId));
    }
  }
 else {
    if (adapterInfo.position >= adapter.getCount()) {
      return;
    }
    final cgCache cache=adapter.getItem(adapterInfo.position);
    if (StringUtils.isNotBlank(cache.getName())) {
      menu.setHeaderTitle(cache.getName());
    }
 else {
      menu.setHeaderTitle(cache.getGeocode());
    }
    if (cache.getCoords() != null) {
      menu.add(0,MENU_COMPASS,0,res.getString(R.string.cache_menu_compass));
      SubMenu subMenu=menu.addSubMenu(1,0,0,res.getString(R.string.cache_menu_navigate)).setIcon(android.R.drawable.ic_menu_mapmode);
      NavigationAppFactory.addMenuItems(subMenu,this,res);
      addVisitMenu(menu,cache);
      menu.add(0,MENU_CACHE_DETAILS,0,res.getString(R.string.cache_menu_details));
    }
    if (cache.getReason() >= 1) {
      menu.add(0,MENU_DROP_CACHE,0,res.getString(R.string.cache_offline_drop));
      List<cgList> cacheLists=app.getLists();
      int listCount=cacheLists.size();
      if (listCount > 1) {
        SubMenu submenu=menu.addSubMenu(0,MENU_MOVE_TO_LIST,0,res.getString(R.string.cache_menu_move_list));
        for (int i=0; i < listCount; i++) {
          cgList list=cacheLists.get(i);
          submenu.add(Menu.NONE,CONTEXT_MENU_MOVE_TO_LIST + list.id,Menu.NONE,list.title);
        }
      }
    }
  }
}
