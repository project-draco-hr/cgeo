{
  removeGeoAndDir();
  int delay=-1;
  int times=0;
  int ret=MSG_DONE;
  while (!needToStop && times < 3 * 60 / 5) {
    String deviceCode=Settings.getWebDeviceCode();
    if (deviceCode == null) {
      deviceCode="";
    }
    final Parameters params=new Parameters("code",deviceCode);
    final HttpResponse responseFromWeb=Network.getRequest("http://send2.cgeo.org/read.html",params);
    if (responseFromWeb != null && responseFromWeb.getStatusLine().getStatusCode() == 200) {
      final String response=Network.getResponseData(responseFromWeb);
      if (response != null && response.length() > 2) {
        delay=1;
        handler.sendMessage(handler.obtainMessage(1,response));
        yield();
        Geocache.storeCache(null,response,listIdLFW,false,null);
        handler.sendMessage(handler.obtainMessage(2,response));
        yield();
      }
 else       if ("RG".equals(response)) {
        Settings.setWebNameCode(null,null);
        ret=-3;
        needToStop=true;
        break;
      }
 else {
        delay=0;
        handler.sendEmptyMessage(0);
        yield();
      }
    }
    if (responseFromWeb == null || responseFromWeb.getStatusLine().getStatusCode() != 200) {
      ret=-2;
      needToStop=true;
      break;
    }
    try {
      yield();
      if (delay == 0) {
        sleep(5000);
        times++;
      }
 else {
        sleep(500);
        times=0;
      }
    }
 catch (    final InterruptedException e) {
      Log.e("cgeocaches.LoadFromWebThread.sleep",e);
    }
  }
  handler.sendEmptyMessage(ret);
  startGeoAndDir();
}
