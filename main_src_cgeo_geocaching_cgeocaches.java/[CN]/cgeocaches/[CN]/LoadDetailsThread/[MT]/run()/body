{
  removeGeoAndDir();
  final List<Geocache> cachesWithStaticMaps=new ArrayList<Geocache>(this.caches.size());
  for (  Geocache cache : this.caches) {
    if (Settings.isStoreOfflineMaps() && cache.hasStaticMap()) {
      cachesWithStaticMaps.add(cache);
      continue;
    }
    if (!refreshCache(cache)) {
      cachesWithStaticMaps.clear();
      break;
    }
  }
  for (  Geocache cache : cachesWithStaticMaps) {
    if (!refreshCache(cache)) {
      break;
    }
  }
  handler.sendEmptyMessage(MSG_RESTART_GEO_AND_DIR);
  handler.sendEmptyMessage(MSG_DONE);
}
