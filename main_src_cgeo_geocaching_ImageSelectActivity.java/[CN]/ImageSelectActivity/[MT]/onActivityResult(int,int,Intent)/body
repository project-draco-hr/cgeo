{
  if (resultCode == RESULT_CANCELED) {
    showToast("Cancelled");
    return;
  }
  if (resultCode == RESULT_OK) {
    if (requestCode == SELECT_NEW_IMAGE) {
      showToast("Image saved to:\n" + imageUri);
      if (data != null) {
        Log.d("SELECT_NEW_IMAGE data = " + data.toString());
      }
 else {
        Log.d("SELECT_NEW_IMAGE data is null");
      }
    }
 else     if (requestCode == SELECT_STORED_IMAGE) {
      Uri selectedImage=data.getData();
      String[] filePathColumn={MediaColumns.DATA};
      Cursor cursor=getContentResolver().query(selectedImage,filePathColumn,null,null,null);
      cursor.moveToFirst();
      int columnIndex=cursor.getColumnIndex(filePathColumn[0]);
      String filePath=cursor.getString(columnIndex);
      imageUri=Uri.parse(filePath);
      cursor.close();
      if (data != null) {
        Log.d("SELECT_STORED_IMAGE data = " + data.toString());
      }
 else {
        Log.d("SELECT_STORED_IMAGE data is null");
      }
    }
  }
 else {
    showToast("Unknown Error");
    return;
  }
  loadImagePreview();
}
