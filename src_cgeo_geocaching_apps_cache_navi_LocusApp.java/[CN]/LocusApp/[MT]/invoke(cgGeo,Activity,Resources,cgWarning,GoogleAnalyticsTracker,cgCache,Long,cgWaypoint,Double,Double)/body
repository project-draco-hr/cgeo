{
  if (cache == null && waypoint == null && latitude == null && longitude == null) {
    return false;
  }
  try {
    if (isInstalled(activity)) {
      final ArrayList<cgWaypoint> waypoints=new ArrayList<cgWaypoint>();
      if (cache != null && cache.waypoints != null && cache.waypoints.isEmpty() == false) {
        for (        cgWaypoint wp : cache.waypoints) {
          if (wp.latitude != null && wp.longitude != null) {
            waypoints.add(wp);
          }
        }
      }
      final ByteArrayOutputStream baos=new ByteArrayOutputStream();
      final DataOutputStream dos=new DataOutputStream(baos);
      dos.writeInt(1);
      if (cache != null) {
        if (waypoints == null || waypoints.isEmpty() == true) {
          dos.writeInt(1);
        }
 else {
          dos.writeInt((1 + waypoints.size()));
        }
      }
 else {
        dos.writeInt(1);
      }
      int icon=-1;
      if (cache != null) {
        icon=cgBase.getIcon(true,cache.type,cache.own,cache.found,cache.disabled || cache.archived);
      }
 else       if (waypoint != null) {
        icon=cgBase.getIcon(false,waypoint.type,false,false,false);
      }
 else {
        icon=cgBase.getIcon(false,"waypoint",false,false,false);
      }
      if (icon > 0) {
        Bitmap bitmap=BitmapFactory.decodeResource(res,icon);
        ByteArrayOutputStream baos2=new ByteArrayOutputStream();
        bitmap.compress(Bitmap.CompressFormat.PNG,100,baos2);
        byte[] image=baos2.toByteArray();
        dos.writeInt(image.length);
        dos.write(image);
      }
 else {
        dos.writeInt(0);
      }
      if (cache != null && cache.name != null && cache.name.length() > 0) {
        dos.writeUTF(cache.name);
      }
 else       if (waypoint != null && waypoint.name != null && waypoint.name.length() > 0) {
        dos.writeUTF(waypoint.name);
      }
 else {
        dos.writeUTF("");
      }
      if (cache != null && cache.geocode != null && cache.geocode.length() > 0) {
        dos.writeUTF(cache.geocode.toUpperCase());
      }
 else       if (waypoint != null && waypoint.lookup != null && waypoint.lookup.length() > 0) {
        dos.writeUTF(waypoint.lookup.toUpperCase());
      }
 else {
        dos.writeUTF("");
      }
      if (cache != null && cache.geocode != null && cache.geocode.length() > 0) {
        dos.writeUTF("intent;c:geo;cgeo.geocaching;cgeo.geocaching.cgeodetail;geocode;" + cache.geocode);
      }
 else       if (waypoint != null && waypoint.id != null && waypoint.id > 0) {
        dos.writeUTF("intent;c:geo;cgeo.geocaching;cgeo.geocaching.cgeowaypoint;id;" + waypoint.id);
      }
 else {
        dos.writeUTF("");
      }
      if (cache != null && cache.latitude != null && cache.longitude != null) {
        dos.writeDouble(cache.latitude);
        dos.writeDouble(cache.longitude);
      }
 else       if (waypoint != null && waypoint.latitude != null && waypoint.longitude != null) {
        dos.writeDouble(waypoint.latitude);
        dos.writeDouble(waypoint.longitude);
      }
 else {
        dos.writeDouble(latitude);
        dos.writeDouble(longitude);
      }
      if (waypoints != null && waypoints.isEmpty() == false) {
        for (        cgWaypoint wp : waypoints) {
          if (wp == null || wp.latitude == null || wp.longitude == null) {
            continue;
          }
          final int wpIcon=cgBase.getIcon(false,wp.type,false,false,false);
          if (wpIcon > 0) {
            Bitmap bitmap=BitmapFactory.decodeResource(res,wpIcon);
            ByteArrayOutputStream baos2=new ByteArrayOutputStream();
            bitmap.compress(Bitmap.CompressFormat.PNG,100,baos2);
            byte[] image=baos2.toByteArray();
            dos.writeInt(image.length);
            dos.write(image);
          }
 else {
            dos.writeInt(0);
          }
          if (wp.lookup != null && wp.lookup.length() > 0) {
            dos.writeUTF(wp.lookup.toUpperCase());
          }
 else {
            dos.writeUTF("");
          }
          if (wp.name != null && wp.name.length() > 0) {
            dos.writeUTF(wp.name);
          }
 else {
            dos.writeUTF("");
          }
          if (wp.id != null && wp.id > 0) {
            dos.writeUTF("intent;c:geo;cgeo.geocaching;cgeo.geocaching.cgeowaypoint;id;" + wp.id);
          }
 else {
            dos.writeUTF("");
          }
          dos.writeDouble(wp.latitude);
          dos.writeDouble(wp.longitude);
        }
      }
      final Intent intent=new Intent();
      intent.setAction(Intent.ACTION_VIEW);
      intent.setData(Uri.parse("menion.points:data"));
      intent.putExtra("data",baos.toByteArray());
      activity.startActivity(intent);
      sendAnal(activity,tracker,"/external/locus");
      return true;
    }
  }
 catch (  Exception e) {
  }
  return false;
}
