{
  final int length=buffer.length();
  final char[] chars=new char[length];
  buffer.getChars(0,length,chars,0);
  int resultSize=0;
  boolean lastWasWhitespace=false;
  for (  char c : chars) {
    if (c == ' ' || c == '\n' || c == '\r' || c == '\t') {
      if (!lastWasWhitespace) {
        chars[resultSize++]=' ';
      }
      lastWasWhitespace=true;
    }
 else {
      chars[resultSize++]=c;
      lastWasWhitespace=false;
    }
  }
  buffer.setLength(0);
  buffer.append(chars);
}
