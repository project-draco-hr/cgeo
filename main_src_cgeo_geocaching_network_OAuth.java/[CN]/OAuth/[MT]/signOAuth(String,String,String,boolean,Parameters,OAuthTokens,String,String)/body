{
  params.put("oauth_consumer_key",consumerKey,"oauth_nonce",CryptUtils.md5(Long.toString(System.currentTimeMillis())),"oauth_signature_method","HMAC-SHA1","oauth_timestamp",Long.toString(System.currentTimeMillis() / 1000),"oauth_token",StringUtils.defaultString(tokens.getTokenPublic()),"oauth_version","1.0");
  params.sort();
  final List<String> paramsEncoded=new ArrayList<>();
  for (  final NameValuePair nameValue : params) {
    paramsEncoded.add(nameValue.getName() + "=" + percentEncode(nameValue.getValue()));
  }
  final String keysPacked=consumerSecret + "&" + StringUtils.defaultString(tokens.getTokenSecret());
  final @NonNull String joinedParams=StringUtils.join(paramsEncoded.toArray(),'&');
  final String requestPacked=method + "&" + percentEncode((https ? "https" : "http") + "://" + host+ path)+ "&"+ percentEncode(joinedParams);
  params.put("oauth_signature",CryptUtils.base64Encode(CryptUtils.hashHmac(requestPacked,keysPacked)));
}
