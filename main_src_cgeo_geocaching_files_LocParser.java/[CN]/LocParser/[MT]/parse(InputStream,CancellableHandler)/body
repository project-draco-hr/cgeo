{
  final String streamContent=readStream(stream,null).toString();
  final int maxSize=streamContent.length();
  final Map<String,Geocache> coords=parseCoordinates(streamContent);
  final List<Geocache> caches=new ArrayList<Geocache>();
  for (  Entry<String,Geocache> entry : coords.entrySet()) {
    Geocache coord=entry.getValue();
    if (StringUtils.isBlank(coord.getGeocode()) || StringUtils.isBlank(coord.getName())) {
      continue;
    }
    Geocache cache=new Geocache();
    cache.setReliableLatLon(true);
    copyCoordToCache(coord,cache);
    caches.add(cache);
    fixCache(cache);
    cache.setType(CacheType.UNKNOWN);
    cache.setListId(listId);
    cache.setDetailed(true);
    cache.store(null);
    progressHandler.sendMessage(progressHandler.obtainMessage(0,maxSize * caches.size() / coords.size(),0));
  }
  Log.i("Caches found in .loc file: " + caches.size());
  return caches;
}
