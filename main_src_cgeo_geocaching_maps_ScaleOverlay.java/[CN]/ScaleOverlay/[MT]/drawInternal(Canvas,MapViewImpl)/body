{
  final double span=mapView.getLongitudeSpan() / 1e6;
  final GeoPointImpl center=mapView.getMapViewCenter();
  final int bottom=mapView.getHeight() - 14;
  final Geopoint leftCoords=new Geopoint(center.getLatitudeE6() / 1e6,center.getLongitudeE6() / 1e6 - span / 2);
  final Geopoint rightCoords=new Geopoint(center.getLatitudeE6() / 1e6,center.getLongitudeE6() / 1e6 + span / 2);
  String units;
  double distance=leftCoords.distanceTo(rightCoords) * SCALE_WIDTH_FACTOR;
  if (Settings.isUseMetricUnits()) {
    if (distance >= 1) {
      units="km";
    }
 else {
      distance*=1000;
      units="m";
    }
  }
 else {
    distance/=IConversion.MILES_TO_KILOMETER;
    if (distance >= 1) {
      units="mi";
    }
 else {
      distance*=5280;
      units="ft";
    }
  }
  final double distanceRound=keepSignificantDigit(distance);
  final double pixels=Math.round((mapView.getWidth() * SCALE_WIDTH_FACTOR / distance) * distanceRound);
  if (blur == null) {
    blur=new BlurMaskFilter(3,BlurMaskFilter.Blur.NORMAL);
  }
  if (scaleShadow == null) {
    scaleShadow=new Paint();
    scaleShadow.setAntiAlias(true);
    scaleShadow.setStrokeWidth(4 * pixelDensity);
    scaleShadow.setMaskFilter(blur);
    scaleShadow.setTextSize(14 * pixelDensity);
    scaleShadow.setTypeface(Typeface.DEFAULT_BOLD);
  }
  if (scale == null) {
    scale=new Paint();
    scale.setAntiAlias(true);
    scale.setStrokeWidth(2 * pixelDensity);
    scale.setTextSize(14 * pixelDensity);
    scale.setTypeface(Typeface.DEFAULT_BOLD);
  }
  if (mapView.needsInvertedColors()) {
    scaleShadow.setColor(0xFF000000);
    scale.setColor(0xFFFFFFFF);
  }
 else {
    scaleShadow.setColor(0xFFFFFFFF);
    scale.setColor(0xFF000000);
  }
  canvas.drawLine(10,bottom,10,(bottom - (8 * pixelDensity)),scaleShadow);
  canvas.drawLine((int)(pixels + 10),bottom,(int)(pixels + 10),(bottom - (8 * pixelDensity)),scaleShadow);
  canvas.drawLine(8,bottom,(int)(pixels + 12),bottom,scaleShadow);
  canvas.drawText(String.format("%.0f",distanceRound) + " " + units,(float)(pixels - (10 * pixelDensity)),(bottom - (10 * pixelDensity)),scaleShadow);
  canvas.drawLine(11,bottom,11,(bottom - (6 * pixelDensity)),scale);
  canvas.drawLine((int)(pixels + 9),bottom,(int)(pixels + 9),(bottom - (6 * pixelDensity)),scale);
  canvas.drawLine(10,bottom,(int)(pixels + 10),bottom,scale);
  canvas.drawText(String.format("%.0f",distanceRound) + " " + units,(float)(pixels - (10 * pixelDensity)),(bottom - (10 * pixelDensity)),scale);
}
