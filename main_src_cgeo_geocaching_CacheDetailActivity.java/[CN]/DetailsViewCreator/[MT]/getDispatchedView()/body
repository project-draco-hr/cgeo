{
  if (cache == null) {
    return null;
  }
  view=(ScrollView)getLayoutInflater().inflate(R.layout.cacheview_details,null);
  if (Settings.isStoreOfflineMaps()) {
    new PreviewMapTask().execute((Void)null);
  }
  detailsList=(LinearLayout)view.findViewById(R.id.details_list);
  Spannable span=(new Spannable.Factory()).newSpannable(Html.fromHtml(cache.getName()).toString());
  if (cache.isDisabled() || cache.isArchived()) {
    span.setSpan(new StrikethroughSpan(),0,span.toString().length(),Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);
  }
  addCacheDetail(R.string.cache_name,span);
  addCacheDetail(R.string.cache_type,cache.getType().getL10n());
  if (null != cache.getSize() && cache.showSize()) {
    addCacheDetail(R.string.cache_size,cache.getSize().getL10n());
  }
  addCacheDetail(R.string.cache_geocode,cache.getGeocode().toUpperCase());
  if (cache.isLogOffline() || cache.isArchived() || cache.isDisabled()|| cache.isPremiumMembersOnly()|| cache.isFound()) {
    List<String> states=new ArrayList<String>(5);
    if (cache.isLogOffline()) {
      states.add(res.getString(R.string.cache_status_offline_log));
    }
    if (cache.isFound()) {
      states.add(res.getString(R.string.cache_status_found));
    }
    if (cache.isArchived()) {
      states.add(res.getString(R.string.cache_status_archived));
    }
    if (cache.isDisabled()) {
      states.add(res.getString(R.string.cache_status_disabled));
    }
    if (cache.isPremiumMembersOnly()) {
      states.add(res.getString(R.string.cache_status_premium));
    }
    addCacheDetail(R.string.cache_status,StringUtils.join(states,", "));
  }
  cacheDistanceView=addCacheDetail(R.string.cache_distance,cache.getDistance() != null ? "~" + HumanDistance.getHumanDistance(cache.getDistance()) : "--");
  if (cache.getDifficulty() > 0) {
    addStarRating(R.string.cache_difficulty,cache.getDifficulty());
  }
  if (cache.getTerrain() > 0) {
    addStarRating(R.string.cache_terrain,cache.getTerrain());
  }
  if (cache.getRating() > 0) {
    final RelativeLayout itemLayout=addStarRating(R.string.cache_rating,cache.getRating());
    if (cache.getVotes() > 0) {
      final TextView itemAddition=(TextView)itemLayout.findViewById(R.id.addition);
      itemAddition.setText("(" + cache.getVotes() + ")");
      itemAddition.setVisibility(View.VISIBLE);
    }
  }
  addCacheDetail(R.string.cache_favourite,cache.getFavoritePoints() + "??");
  if (cache.getMyVote() > 0) {
    addStarRating(R.string.cache_own_rating,cache.getMyVote());
  }
  if (StringUtils.isNotBlank(cache.getOwner()) || StringUtils.isNotBlank(cache.getOwnerReal())) {
    TextView ownerView=addCacheDetail(R.string.cache_owner,"");
    if (StringUtils.isNotBlank(cache.getOwner())) {
      ownerView.setText(Html.fromHtml(cache.getOwner()),TextView.BufferType.SPANNABLE);
    }
 else {
      ownerView.setText(Html.fromHtml(cache.getOwnerReal()),TextView.BufferType.SPANNABLE);
    }
    ownerView.setOnClickListener(new OwnerActionsClickListener());
  }
  if (cache.getHiddenDate() != null) {
    long time=cache.getHiddenDate().getTime();
    if (time > 0) {
      String dateString=Formatter.formatFullDate(time);
      if (cache.isEventCache()) {
        dateString=DateUtils.formatDateTime(cgeoapplication.getInstance().getBaseContext(),time,DateUtils.FORMAT_SHOW_WEEKDAY) + ", " + dateString;
      }
      addCacheDetail(cache.isEventCache() ? R.string.cache_event : R.string.cache_hidden,dateString);
    }
  }
  if (StringUtils.isNotBlank(cache.getLocation())) {
    addCacheDetail(R.string.cache_location,cache.getLocation());
  }
  if (cache.getCoords() != null) {
    TextView valueView=addCacheDetail(R.string.cache_coordinates,cache.getCoords().toString());
    valueView.setOnClickListener(new View.OnClickListener(){
      private int position=0;
      private GeopointFormatter.Format[] availableFormats=new GeopointFormatter.Format[]{GeopointFormatter.Format.LAT_LON_DECMINUTE,GeopointFormatter.Format.LAT_LON_DECSECOND,GeopointFormatter.Format.LAT_LON_DECDEGREE};
      @Override public void onClick(      View view){
        position=(position + 1) % availableFormats.length;
        final TextView valueView=(TextView)view.findViewById(R.id.value);
        valueView.setText(cache.getCoords().format(availableFormats[position]));
      }
    }
);
    registerForContextMenu(valueView);
  }
  if (cache.hasAttributes()) {
    new AttributeViewBuilder().fillView((LinearLayout)view.findViewById(R.id.attributes_innerbox));
    view.findViewById(R.id.attributes_box).setVisibility(View.VISIBLE);
  }
  updateOfflineBox();
  Button buttonWatchlistAdd=(Button)view.findViewById(R.id.add_to_watchlist);
  Button buttonWatchlistRemove=(Button)view.findViewById(R.id.remove_from_watchlist);
  buttonWatchlistAdd.setOnClickListener(new AddToWatchlistClickListener());
  buttonWatchlistRemove.setOnClickListener(new RemoveFromWatchlistClickListener());
  updateWatchlistBox();
  IConnector connector=ConnectorFactory.getConnector(cache);
  if (connector != null) {
    String license=connector.getLicenseText(cache);
    if (StringUtils.isNotBlank(license)) {
      ((LinearLayout)view.findViewById(R.id.license_box)).setVisibility(View.VISIBLE);
      TextView licenseView=((TextView)view.findViewById(R.id.license));
      licenseView.setText(Html.fromHtml(license),BufferType.SPANNABLE);
      licenseView.setClickable(true);
      licenseView.setMovementMethod(LinkMovementMethod.getInstance());
    }
 else {
      ((LinearLayout)view.findViewById(R.id.license_box)).setVisibility(View.GONE);
    }
  }
  if (geolocation != null) {
    locationUpdater.updateLocation(geolocation);
  }
  return view;
}
