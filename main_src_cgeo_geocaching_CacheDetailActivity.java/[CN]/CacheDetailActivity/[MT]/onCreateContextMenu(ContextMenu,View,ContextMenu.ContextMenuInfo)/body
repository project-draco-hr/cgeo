{
  super.onCreateContextMenu(menu,view,info);
  final int viewId=view.getId();
switch (viewId) {
case R.id.value:
    clickedItemText=((TextView)view).getText();
  final String itemTitle=(String)((TextView)((View)view.getParent()).findViewById(R.id.name)).getText();
buildDetailsContextMenu(menu,itemTitle,true);
break;
case R.id.shortdesc:
clickedItemText=((TextView)view).getText();
buildDetailsContextMenu(menu,res.getString(R.string.cache_description),false);
break;
case R.id.longdesc:
final String shortDesc=cache.getShortDescription();
if (StringUtils.isBlank(shortDesc)) {
clickedItemText=((TextView)view).getText();
}
 else {
clickedItemText=shortDesc + "\n\n" + ((TextView)view).getText();
}
buildDetailsContextMenu(menu,res.getString(R.string.cache_description),false);
break;
case R.id.personalnote:
clickedItemText=((TextView)view).getText();
buildDetailsContextMenu(menu,res.getString(R.string.cache_personal_note),true);
break;
case R.id.hint:
clickedItemText=((TextView)view).getText();
buildDetailsContextMenu(menu,res.getString(R.string.cache_hint),false);
break;
case R.id.log:
clickedItemText=((TextView)view).getText();
buildDetailsContextMenu(menu,res.getString(R.string.cache_logs),false);
break;
case -1:
if (null != cache.getWaypoints()) {
try {
final ViewGroup parent=((ViewGroup)view.getParent());
for (int i=0; i < parent.getChildCount(); i++) {
if (parent.getChildAt(i) == view) {
final List<Waypoint> sortedWaypoints=new ArrayList<Waypoint>(cache.getWaypoints());
Collections.sort(sortedWaypoints);
selectedWaypoint=sortedWaypoints.get(i);
menu.setHeaderTitle(res.getString(R.string.waypoint));
getMenuInflater().inflate(R.menu.waypoint_options,menu);
final boolean isOriginalWaypoint=selectedWaypoint.getWaypointType().equals(WaypointType.ORIGINAL);
menu.findItem(R.id.menu_waypoint_reset_cache_coords).setVisible(isOriginalWaypoint);
menu.findItem(R.id.menu_waypoint_edit).setVisible(!isOriginalWaypoint);
menu.findItem(R.id.menu_waypoint_duplicate).setVisible(!isOriginalWaypoint);
final boolean userDefined=selectedWaypoint.isUserDefined() && !selectedWaypoint.getWaypointType().equals(WaypointType.ORIGINAL);
menu.findItem(R.id.menu_waypoint_delete).setVisible(userDefined);
final boolean hasCoords=selectedWaypoint.getCoords() != null;
final MenuItem defaultNavigationMenu=menu.findItem(R.id.menu_waypoint_navigate_default);
defaultNavigationMenu.setVisible(hasCoords);
defaultNavigationMenu.setTitle(NavigationAppFactory.getDefaultNavigationApplication().getName());
menu.findItem(R.id.menu_waypoint_navigate).setVisible(hasCoords);
menu.findItem(R.id.menu_waypoint_caches_around).setVisible(hasCoords);
break;
}
}
}
 catch (final RuntimeException e) {
}
}
break;
default :
if (imagesList != null) {
imagesList.onCreateContextMenu(menu,view);
}
break;
}
}
