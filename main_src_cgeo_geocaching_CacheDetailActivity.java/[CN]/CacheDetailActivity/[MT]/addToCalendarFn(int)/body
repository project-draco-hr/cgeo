{
  if (MapUtils.isEmpty(calendars)) {
    return;
  }
  try {
    Uri calendarProvider=Compatibility.getCalenderEventsProviderURI();
    final Integer[] keys=calendars.keySet().toArray(new Integer[calendars.size()]);
    final Integer calId=keys[index];
    final Date eventDate=cache.getHiddenDate();
    eventDate.setHours(0);
    eventDate.setMinutes(0);
    eventDate.setSeconds(0);
    StringBuilder description=new StringBuilder();
    description.append(cache.getUrl());
    description.append("\n\n");
    if (StringUtils.isNotBlank(cache.getShortdesc())) {
      description.append(Html.fromHtml(cache.getShortdesc()).toString());
    }
    if (StringUtils.isNotBlank(cache.getPersonalNote())) {
      description.append("\n\n" + Html.fromHtml(cache.getPersonalNote()).toString());
    }
    ContentValues event=new ContentValues();
    event.put("calendar_id",calId);
    event.put("dtstart",eventDate.getTime() + 43200000);
    event.put("dtend",eventDate.getTime() + 43200000 + 3600000);
    event.put("eventTimezone","UTC");
    event.put("title",Html.fromHtml(cache.getName()).toString());
    event.put("description",description.toString());
    String location="";
    if (cache.getCoords() != null) {
      location+=cache.getCoords().format(GeopointFormatter.Format.LAT_LON_DECMINUTE_RAW);
    }
    if (StringUtils.isNotBlank(cache.getLocation())) {
      boolean addParenteses=false;
      if (location.length() > 0) {
        addParenteses=true;
        location+=" (";
      }
      location+=Html.fromHtml(cache.getLocation()).toString();
      if (addParenteses) {
        location+=")";
      }
    }
    if (location.length() > 0) {
      event.put("eventLocation",location);
    }
    event.put("allDay",1);
    event.put("hasAlarm",0);
    getContentResolver().insert(calendarProvider,event);
    showToast(res.getString(R.string.event_success));
  }
 catch (  Exception e) {
    showToast(res.getString(R.string.event_fail));
    Log.e(Settings.tag,"CacheDetailActivity.addToCalendarFn: " + e.toString());
  }
}
