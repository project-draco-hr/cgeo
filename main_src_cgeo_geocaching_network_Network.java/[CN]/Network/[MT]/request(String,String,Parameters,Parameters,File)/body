{
  HttpRequestBase request;
  if (method.equals("GET")) {
    final String fullUri=params == null ? uri : Uri.parse(uri).buildUpon().encodedQuery(params.toString()).build().toString();
    request=new HttpGet(fullUri);
  }
 else {
    request=new HttpPost(uri);
    if (params != null) {
      try {
        ((HttpPost)request).setEntity(new UrlEncodedFormEntity(params,CharEncoding.UTF_8));
      }
 catch (      final UnsupportedEncodingException e) {
        Log.e("request",e);
        return null;
      }
    }
  }
  addHeaders(request,headers,cacheFile);
  return doLogRequest(request);
}
