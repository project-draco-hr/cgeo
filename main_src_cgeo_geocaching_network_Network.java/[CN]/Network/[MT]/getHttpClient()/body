{
  final DefaultHttpClient client=new DefaultHttpClient();
  client.setCookieStore(Cookies.cookieStore);
  client.setParams(clientParams);
  client.setRedirectStrategy(new LaxRedirectStrategy());
  client.addRequestInterceptor(new HttpRequestInterceptor(){
    @Override public void process(    final HttpRequest request,    final HttpContext context) throws HttpException, IOException {
      if (!request.containsHeader("Accept-Encoding")) {
        request.addHeader("Accept-Encoding","gzip");
      }
    }
  }
);
  client.addResponseInterceptor(new HttpResponseInterceptor(){
    @Override public void process(    final HttpResponse response,    final HttpContext context) throws HttpException, IOException {
      final HttpEntity entity=response.getEntity();
      if (entity != null) {
        final Header contentEncoding=entity.getContentEncoding();
        if (contentEncoding != null) {
          for (          final HeaderElement codec : contentEncoding.getElements()) {
            if (codec.getName().equalsIgnoreCase("gzip")) {
              response.setEntity(new GzipDecompressingEntity(response.getEntity()));
              return;
            }
          }
        }
      }
    }
  }
);
  return client;
}
