{
  final int id=item.getItemId();
  if (id == 1) {
    if (mapView != null && mapView.isSatellite() == false) {
      mapView.setSatellite(true);
      prefsEdit.putInt("maptype",cgSettings.mapSatellite);
      prefsEdit.commit();
    }
 else {
      mapView.setSatellite(false);
      prefsEdit.putInt("maptype",cgSettings.mapClassic);
      prefsEdit.commit();
    }
    return true;
  }
 else   if (id == 2) {
    if (settings.maptrail == 1) {
      prefsEdit.putInt("maptrail",0);
      prefsEdit.commit();
      settings.maptrail=0;
    }
 else {
      prefsEdit.putInt("maptrail",1);
      prefsEdit.commit();
      settings.maptrail=1;
    }
  }
 else   if (id == 3) {
    if (settings.maplive == 1) {
      settings.liveMapDisable();
    }
 else {
      settings.liveMapEnable();
    }
    liveChanged=true;
    searchId=null;
    searchIdIntent=null;
  }
 else   if (id == 4) {
    if (live && !isLoading() && caches != null && !caches.isEmpty()) {
      final ArrayList<String> geocodes=new ArrayList<String>();
      ArrayList<cgCache> cachesProtected=(ArrayList<cgCache>)caches.clone();
      try {
        if (cachesProtected != null && cachesProtected.size() > 0) {
          final GeoPointImpl mapCenter=mapView.getMapViewCenter();
          final int mapCenterLat=mapCenter.getLatitudeE6();
          final int mapCenterLon=mapCenter.getLongitudeE6();
          final int mapSpanLat=mapView.getLatitudeSpan();
          final int mapSpanLon=mapView.getLongitudeSpan();
          for (          cgCache oneCache : cachesProtected) {
            if (oneCache != null && oneCache.latitude != null && oneCache.longitude != null) {
              if (base.isCacheInViewPort(mapCenterLat,mapCenterLon,mapSpanLat,mapSpanLon,oneCache.latitude,oneCache.longitude) && app.isOffline(oneCache.geocode,null) == false) {
                geocodes.add(oneCache.geocode);
              }
            }
          }
        }
      }
 catch (      Exception e) {
        Log.e(cgSettings.tag,"cgeomap.onOptionsItemSelected.#4: " + e.toString());
      }
      detailTotal=geocodes.size();
      if (detailTotal == 0) {
        warning.showToast(res.getString(R.string.warn_save_nothing));
        return true;
      }
      waitDialog=new ProgressDialog(activity);
      waitDialog.setProgressStyle(ProgressDialog.STYLE_HORIZONTAL);
      waitDialog.setCancelable(true);
      waitDialog.setMax(detailTotal);
      waitDialog.setOnCancelListener(new DialogInterface.OnCancelListener(){
        public void onCancel(        DialogInterface arg0){
          try {
            if (loadDetailsThread != null) {
              loadDetailsThread.stopIt();
            }
            if (geo == null) {
              geo=app.startGeo(activity,geoUpdate,base,settings,warning,0,0);
            }
            if (settings.useCompass == 1 && dir == null) {
              dir=app.startDir(activity,dirUpdate,warning);
            }
          }
 catch (          Exception e) {
            Log.e(cgSettings.tag,"cgeocaches.onPrepareOptionsMenu.onCancel: " + e.toString());
          }
        }
      }
);
      Float etaTime=new Float((detailTotal * (float)7) / 60);
      if (etaTime < 0.4) {
        waitDialog.setMessage(res.getString(R.string.caches_downloading) + " " + res.getString(R.string.caches_eta_ltm));
      }
 else       if (etaTime < 1.5) {
        waitDialog.setMessage(res.getString(R.string.caches_downloading) + " " + String.format(Locale.getDefault(),"%.0f",etaTime)+ " "+ res.getString(R.string.caches_eta_min));
      }
 else {
        waitDialog.setMessage(res.getString(R.string.caches_downloading) + " " + String.format(Locale.getDefault(),"%.0f",etaTime)+ " "+ res.getString(R.string.caches_eta_mins));
      }
      waitDialog.show();
      detailProgressTime=System.currentTimeMillis();
      loadDetailsThread=new LoadDetails(loadDetailsHandler,geocodes);
      loadDetailsThread.start();
      return true;
    }
  }
 else   if (id == 5) {
    if (overlayCaches == null) {
      return false;
    }
    overlayCaches.switchCircles();
  }
  return false;
}
