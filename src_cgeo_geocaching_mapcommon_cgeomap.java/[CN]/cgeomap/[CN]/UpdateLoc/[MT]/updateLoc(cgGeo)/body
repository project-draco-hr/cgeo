{
  if (geo == null) {
    return;
  }
  try {
    boolean repaintRequired=false;
    if (overlayMyLoc == null && mapView != null) {
      overlayMyLoc=mapView.createAddPositionOverlay(activity,settings);
    }
    if (overlayMyLoc != null && geo.location != null) {
      overlayMyLoc.setCoordinates(geo.location);
    }
    if (geo.coordsNow != null) {
      if (followMyLocation) {
        myLocationInMiddle();
      }
 else {
        repaintRequired=true;
      }
    }
    if (settings.useCompass == 0 || (geo.speedNow != null && geo.speedNow > 5)) {
      if (geo.bearingNow != null) {
        overlayMyLoc.setHeading(geo.bearingNow);
      }
 else {
        overlayMyLoc.setHeading(Double.valueOf(0));
      }
      repaintRequired=true;
    }
    if (repaintRequired) {
      mapView.repaintRequired(overlayMyLoc);
    }
  }
 catch (  Exception e) {
    Log.w(cgSettings.tag,"Failed to update location.");
  }
}
