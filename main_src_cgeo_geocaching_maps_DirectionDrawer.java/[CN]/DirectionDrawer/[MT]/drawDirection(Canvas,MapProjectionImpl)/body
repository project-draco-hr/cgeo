{
  if (currentCoords == null) {
    return;
  }
  if (!Settings.isMapDirection()) {
    return;
  }
  if (line == null) {
    line=new Paint();
    line.setAntiAlias(true);
    line.setStrokeWidth(width);
    line.setColor(0x80EB391E);
  }
  Geopoint[] routingPoints=null;
  if (lastDirectionUpdatePoint != null && currentCoords.distanceTo(lastDirectionUpdatePoint) < 0.005) {
    routingPoints=lastRoutingPoints;
  }
 else {
    try {
      routingPoints=BRouter.getTrack(currentCoords,destinationCoords);
      lastRoutingPoints=routingPoints;
      lastDirectionUpdatePoint=currentCoords;
    }
 catch (    SAXException e) {
      e.printStackTrace();
    }
  }
  if (routingPoints != null && routingPoints.length > 0) {
    Point lastPoint=null;
    Point currentPoint=new Point();
    for (    Geopoint currentGeoPoint : routingPoints) {
      projection.toPixels(mapItemFactory.getGeoPointBase(currentGeoPoint),currentPoint);
      if (lastPoint != null) {
        canvas.drawLine(lastPoint.x,lastPoint.y,currentPoint.x,currentPoint.y,line);
      }
 else {
        lastPoint=new Point();
      }
      lastPoint.x=currentPoint.x;
      lastPoint.y=currentPoint.y;
    }
  }
 else {
    final Point pos=new Point();
    final Point dest=new Point();
    projection.toPixels(mapItemFactory.getGeoPointBase(currentCoords),pos);
    projection.toPixels(mapItemFactory.getGeoPointBase(destinationCoords),dest);
    canvas.drawLine(pos.x,pos.y,dest.x,dest.y,line);
  }
}
