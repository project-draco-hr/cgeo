{
  final String geocode="GC31J2H";
  removeCacheCompletely(geocode);
  final File gc31j2h=new File(tempDir,"gc31j2h.gpx");
  copyResourceToFile(R.raw.gc31j2h,gc31j2h);
  final GPXImporter.ImportGpxFileThread importThread=new GPXImporter.ImportGpxFileThread(gc31j2h,listId,importStepHandler,progressHandler);
  runImportThread(importThread);
  assertEquals(4,importStepHandler.messages.size());
  final Iterator<Message> iMsg=importStepHandler.messages.iterator();
  assertEquals(GPXImporter.IMPORT_STEP_START,iMsg.next().what);
  assertEquals(GPXImporter.IMPORT_STEP_READ_FILE,iMsg.next().what);
  assertEquals(GPXImporter.IMPORT_STEP_STORE_STATIC_MAPS,iMsg.next().what);
  assertEquals(GPXImporter.IMPORT_STEP_FINISHED,iMsg.next().what);
  final SearchResult search=(SearchResult)importStepHandler.messages.get(3).obj;
  assertEquals(Collections.singletonList(geocode),new ArrayList<String>(search.getGeocodes()));
  final Geocache cache=DataStore.loadCache(geocode,LoadFlags.LOAD_CACHE_OR_DB);
  assertCacheProperties(cache);
  assertTrue(cache.getWaypoints().isEmpty());
}
