{
  super.onCreate(savedInstanceState);
  setTheme();
  setContentView(R.layout.cacheslist_activity);
  Bundle extras=getIntent().getExtras();
  if (extras != null) {
    final Object typeObject=extras.get(Intents.EXTRA_LIST_TYPE);
    type=(typeObject instanceof CacheListType) ? (CacheListType)typeObject : CacheListType.OFFLINE;
    coords=extras.getParcelable(Intents.EXTRA_COORDS);
  }
 else {
    extras=new Bundle();
  }
  if (isInvokedFromAttachment()) {
    type=CacheListType.OFFLINE;
    if (coords == null) {
      coords=Geopoint.ZERO;
    }
  }
  setTitle(title);
  initAdapter();
  prepareFilterBar();
  if (type.canSwitch) {
    initActionBarSpinner();
  }
  currentLoader=(AbstractSearchLoader)getSupportLoaderManager().initLoader(type.getLoaderId(),extras,this);
  if (CollectionUtils.isNotEmpty(cacheList)) {
    if (currentLoader != null && currentLoader.isStarted()) {
      showFooterLoadingCaches();
    }
 else {
      showFooterMoreCaches();
    }
  }
  if (isInvokedFromAttachment()) {
    importGpxAttachement();
  }
}
