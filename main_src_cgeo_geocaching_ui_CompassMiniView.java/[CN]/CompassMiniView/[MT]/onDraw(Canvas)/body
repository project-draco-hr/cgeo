{
  super.onDraw(canvas);
  float azimuthRelative=azimuth - heading;
  if (azimuthRelative < 0) {
    azimuthRelative+=360;
  }
 else   if (azimuthRelative >= 360) {
    azimuthRelative-=360;
  }
  canvas.setDrawFilter(FILTER_SET);
  final int canvasCenterX=(compassArrowWidth / 2) + ((getWidth() - compassArrowWidth) / 2);
  final int canvasCenterY=(compassArrowHeight / 2) + ((getHeight() - compassArrowHeight) / 2);
  final int marginLeft=(getWidth() - compassArrowWidth) / 2;
  final int marginTop=(getHeight() - compassArrowHeight) / 2;
  canvas.rotate(-azimuthRelative,canvasCenterX,canvasCenterY);
  canvas.drawBitmap(compassArrow,marginLeft,marginTop,null);
  canvas.rotate(azimuthRelative,canvasCenterX,canvasCenterY);
  canvas.setDrawFilter(FILTER_REMOVE);
}
