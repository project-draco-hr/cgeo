{
  try {
    GPXParser parser=new GPX10Parser(listId);
    boolean parsed=parser.parse(file,handler);
    if (!parsed) {
      parser=new GPX11Parser(listId);
      parsed=parser.parse(file,handler);
    }
    if (parsed) {
      final File wptsFile=getWaypointsFileForGpx(file);
      if (wptsFile != null && wptsFile.canRead()) {
        parser.parse(wptsFile,handler);
      }
    }
    if (parsed) {
      final cgSearch search=new cgSearch();
      final cgeoapplication app=cgeoapplication.getInstance();
      int storedCaches=0;
      for (      cgCache cache : parser.getParsedCaches()) {
        app.removeCacheFromCache(cache.geocode);
        app.addCacheToSearch(search,cache);
        showCountMessage(handler,R.string.gpx_import_storing,++storedCaches);
      }
      Log.i(Settings.tag,"Caches found in .gpx file: " + parser.getParsedCaches().size());
      return search.getCurrentId();
    }
  }
 catch (  Exception e) {
    Log.e(Settings.tag,"cgBase.parseGPX: " + e.toString());
  }
  return null;
}
