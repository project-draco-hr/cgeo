{
  final ArrayList<Drawable> layers=new ArrayList<>(9);
  final ArrayList<int[]> insets=new ArrayList<>(8);
  final Drawable marker=getResources().getDrawable(cache.getMapMarkerId());
  layers.add(marker);
  final int resolution=marker.getIntrinsicWidth() > 40 ? (marker.getIntrinsicWidth() > 50 ? 2 : 1) : 0;
  if (!cache.isReliableLatLon()) {
    insets.add(INSET_RELIABLE[resolution]);
    layers.add(getResources().getDrawable(R.drawable.marker_notreliable));
  }
  layers.add(getResources().getDrawable(cache.getType().markerId));
  insets.add(INSET_TYPE[resolution]);
  if (cache.isOwner()) {
    layers.add(getResources().getDrawable(R.drawable.marker_own));
    insets.add(INSET_OWN[resolution]);
  }
 else   if (cache.getListId() > 0) {
    layers.add(getResources().getDrawable(R.drawable.marker_stored));
    insets.add(INSET_OWN[resolution]);
  }
  if (cache.isFound()) {
    layers.add(getResources().getDrawable(R.drawable.marker_found));
    insets.add(INSET_FOUND[resolution]);
  }
 else   if (cache.isLogOffline()) {
    layers.add(getResources().getDrawable(R.drawable.marker_found_offline));
    insets.add(INSET_FOUND[resolution]);
  }
  if (cache.hasUserModifiedCoords()) {
    layers.add(getResources().getDrawable(R.drawable.marker_usermodifiedcoords));
    insets.add(INSET_USERMODIFIEDCOORDS[resolution]);
  }
  if (cache.getPersonalNote() != null) {
    layers.add(getResources().getDrawable(R.drawable.marker_personalnote));
    insets.add(INSET_PERSONALNOTE[resolution]);
  }
  final LayerDrawable ld=new LayerDrawable(layers.toArray(new Drawable[layers.size()]));
  int index=1;
  for (  final int[] inset : insets) {
    ld.setLayerInset(index++,inset[0],inset[1],inset[2],inset[3]);
  }
  overlaysCache.put(hashcode,ld);
  return ld;
}
