{
  final MapSource oldSource=MapProviderFactory.getMapSource(currentSourceId);
  final boolean restartRequired=oldSource == null || !MapProviderFactory.isSameActivity(oldSource,newSource);
  Settings.setMapSource(newSource);
  currentSourceId=newSource.getNumericalId();
  if (restartRequired) {
    mapRestart();
  }
 else   if (mapView != null) {
    mapStateIntent=currentMapState();
    mapView.setMapSource();
    centered=false;
    centerMap(geocodeIntent,searchIntent,coordsIntent,mapStateIntent);
    ActivityMixin.invalidateOptionsMenu(activity);
  }
  return restartRequired;
}
