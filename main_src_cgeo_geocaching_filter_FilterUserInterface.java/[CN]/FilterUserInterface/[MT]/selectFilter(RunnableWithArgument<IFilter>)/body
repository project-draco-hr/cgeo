{
  final AlertDialog.Builder builder=new AlertDialog.Builder((Activity)activity);
  builder.setTitle(R.string.caches_filter);
  final ArrayAdapter<FactoryEntry> adapter=new ArrayAdapter<FactoryEntry>((Activity)activity,android.R.layout.select_dialog_item,registry);
  builder.setAdapter(adapter,new DialogInterface.OnClickListener(){
    public void onClick(    DialogInterface dialog,    int itemIndex){
      FactoryEntry entry=adapter.getItem(itemIndex);
      if (entry.filterFactory == null) {
        runAfterwards.run(null);
      }
 else {
        try {
          IFilterFactory factoryInstance=entry.filterFactory.newInstance();
          selectFromFactory(factoryInstance,entry.name,runAfterwards);
        }
 catch (        Exception e) {
          Log.e("selectFilter",e);
        }
      }
    }
  }
);
  builder.create().show();
}
