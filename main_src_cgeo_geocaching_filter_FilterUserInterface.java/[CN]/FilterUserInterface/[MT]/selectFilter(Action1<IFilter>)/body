{
  final AlertDialog.Builder builder=new AlertDialog.Builder(activity);
  builder.setTitle(R.string.caches_filter_title);
  final ArrayAdapter<FactoryEntry> adapter=new ArrayAdapter<>(activity,android.R.layout.select_dialog_item,registry);
  builder.setAdapter(adapter,new DialogInterface.OnClickListener(){
    @Override public void onClick(    final DialogInterface dialog,    final int itemIndex){
      final FactoryEntry entry=adapter.getItem(itemIndex);
      if (entry.filterFactory == null) {
        runAfterwards.call(null);
      }
 else {
        try {
          final IFilterFactory factoryInstance=entry.filterFactory.newInstance();
          selectFromFactory(factoryInstance,entry.name,runAfterwards);
        }
 catch (        final Exception e) {
          Log.e("selectFilter",e);
        }
      }
    }
  }
);
  builder.create().show();
}
