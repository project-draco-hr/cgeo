{
  try {
    final StatusCode status=cgBase.postLog(app,geocode,cacheid,viewstates,typeSelected,date.get(Calendar.YEAR),(date.get(Calendar.MONTH) + 1),date.get(Calendar.DATE),log,trackables);
    if (status == StatusCode.NO_ERROR) {
      final cgLog logNow=new cgLog();
      logNow.author=Settings.getUsername();
      logNow.date=date.getTimeInMillis();
      logNow.type=typeSelected;
      logNow.log=log;
      if (cache != null) {
        cache.prependLog(logNow);
      }
      app.addLog(geocode,logNow);
      if (typeSelected == LogType.LOG_FOUND_IT) {
        app.markFound(geocode);
        if (cache != null) {
          cache.setFound(true);
        }
      }
      if (cache != null) {
        cgeoapplication.putCacheInCache(cache);
      }
 else {
        cgeoapplication.removeCacheFromCache(geocode);
      }
    }
    if (status == StatusCode.NO_ERROR) {
      app.clearLogOffline(geocode);
    }
    if (status == StatusCode.NO_ERROR && typeSelected == LogType.LOG_FOUND_IT && Settings.isUseTwitter() && Settings.isTwitterLoginValid() && tweetCheck.isChecked() && tweetBox.getVisibility() == View.VISIBLE) {
      cgBase.postTweetCache(app,geocode);
    }
    if (status == StatusCode.NO_ERROR && typeSelected == LogType.LOG_FOUND_IT && Settings.isGCvoteLogin()) {
      GCVote.setRating(cache,rating);
    }
    return status;
  }
 catch (  Exception e) {
    Log.e(Settings.tag,"cgeovisit.postLogFn: " + e.toString());
  }
  return StatusCode.LOG_POST_ERROR;
}
