{
  init();
  if (StringUtils.isBlank(geocode) || MapUtils.isEmpty(logCounts)) {
    return false;
  }
  databaseRW.beginTransaction();
  try {
    if (drop) {
      databaseRW.delete(dbTableLogCount,"geocode = ?",new String[]{geocode});
    }
    ContentValues values=new ContentValues();
    Set<Entry<LogType,Integer>> logCountsItems=logCounts.entrySet();
    long timeStamp=System.currentTimeMillis();
    for (    Entry<LogType,Integer> pair : logCountsItems) {
      values.clear();
      values.put("geocode",geocode);
      values.put("updated",timeStamp);
      values.put("type",pair.getKey().id);
      values.put("count",pair.getValue());
      databaseRW.insert(dbTableLogCount,null,values);
    }
    databaseRW.setTransactionSuccessful();
  }
  finally {
    databaseRW.endTransaction();
  }
  return true;
}
